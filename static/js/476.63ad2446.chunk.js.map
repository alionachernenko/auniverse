{"version":3,"file":"static/js/476.63ad2446.chunk.js","mappings":"mWAEaA,EAAa,SAAHC,GAAoC,IAA9BC,EAAID,EAAJC,KAAMC,EAAKF,EAALE,MAAOC,EAASH,EAATG,UACxC,OACEC,EAAAA,EAAAA,MAACC,EAAI,CAACF,UAAS,mBAAAG,OAAqBH,GAAYI,SAAA,EAC9CC,EAAAA,EAAAA,KAAA,OAAKC,MAAO,CAAEC,MAAOT,EAAMU,OAAQV,EAAMW,gBAAiBV,MAC1DM,EAAAA,EAAAA,KAAA,OAAKC,MAAO,CAAEC,MAAOT,EAAMU,OAAQV,EAAMW,gBAAiBV,MAC1DM,EAAAA,EAAAA,KAAA,OAAKC,MAAO,CAAEC,MAAOT,EAAMU,OAAQV,EAAMW,gBAAiBV,OAGhE,EAEMW,GAAkBC,EAAAA,EAAAA,IAASC,IAAAA,GAAAC,EAAAA,EAAAA,GAAA,wEAO3BX,EAAOY,EAAAA,GAAAA,IAAUC,IAAAA,GAAAF,EAAAA,EAAAA,GAAA,gfAyBNH,GCxBJM,EAAO,WAClB,IAAAC,GAAwCC,EAAAA,EAAAA,MAAiBC,GAAAC,EAAAA,EAAAA,GAAAH,EAAA,GAAlDI,EAAYF,EAAA,GAAEG,EAAeH,EAAA,GACpCI,GAAgCC,EAAAA,EAAAA,UAAS,MAAKC,GAAAL,EAAAA,EAAAA,GAAAG,EAAA,GAAvCG,EAAQD,EAAA,GAAEE,EAAWF,EAAA,GAC5BG,GAAwCJ,EAAAA,EAAAA,UAAS,IAAGK,GAAAT,EAAAA,EAAAA,GAAAQ,EAAA,GAA7CE,EAAYD,EAAA,GAAEE,EAAeF,EAAA,GACpCG,GAAoCR,EAAAA,EAAAA,WAAS,GAAMS,GAAAb,EAAAA,EAAAA,GAAAY,EAAA,GAA5CE,EAAUD,EAAA,GAAEE,EAAaF,EAAA,GACxBG,GAAWC,EAAAA,EAAAA,YAAWC,EAAAA,IAAtBF,OACRG,GAAkCf,EAAAA,EAAAA,WAAS,GAAMgB,GAAApB,EAAAA,EAAAA,GAAAmB,EAAA,GAA1CE,EAASD,EAAA,GAAEE,EAAYF,EAAA,GAC9BG,GAAgCnB,EAAAA,EAAAA,WAAS,GAAMoB,GAAAxB,EAAAA,EAAAA,GAAAuB,EAAA,GAAxCE,EAAQD,EAAA,GAAEE,EAAWF,EAAA,GACtBG,EAAS1B,EAAa2B,IAAI,MAC1BC,EAAc5B,EAAa2B,IAAI,QAErCE,QAAQC,IAAIF,EAAab,IAEzBgB,EAAAA,EAAAA,YAAU,WACR,IAAMC,EAAe,eAAAxD,GAAAyD,EAAAA,EAAAA,IAAAC,EAAAA,EAAAA,KAAAC,MAAG,SAAAC,IAAA,IAAAC,EAAAC,EAAA,OAAAJ,EAAAA,EAAAA,KAAAK,MAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,OAIrB,OAHKL,GAAIM,EAAAA,EAAAA,KACRC,EAAAA,EAAAA,IAAWC,EAAAA,GAAW,UACtBC,EAAAA,EAAAA,IAAM,UAAW,iBAAkBlB,EAAab,IACjDyB,EAAAE,KAAA,GAC2BK,EAAAA,EAAAA,IAAQV,GAAG,KAAD,EAAhCC,EAAaE,EAAAQ,KACnBlC,GAAewB,EAAcW,OACxBX,EAAcW,MAKdhD,EAAgB,CAAEiD,GAAI,MAAOC,KAAMvB,GAAe,SAJrD3B,EAAgB,CACdiD,GAAIZ,EAAcc,KAAK,GAAGF,GAC1BC,KAAMvB,GAAe,SAEwC,wBAAAY,EAAAa,OAAA,GAAAjB,EAAA,KAClE,kBAboB,OAAA5D,EAAA8E,MAAA,KAAAC,UAAA,KAcrBvB,GACF,GAAG,CAACJ,EAAa3B,EAAiBc,KAElCgB,EAAAA,EAAAA,YAAU,WACR,GAAIL,GAAqB,QAAXA,EAAkB,CAC9B,IAAM8B,GAASC,EAAAA,EAAAA,IAAIZ,EAAAA,GAAW,QAASnB,IACvCgC,EAAAA,EAAAA,IAAWF,GAAQ,SAAAG,GAAa,IAADC,EAAAC,EAAAC,EAC7BxD,EAA2B,QAAhBsD,EAACD,EAASI,cAAM,IAAAH,OAAA,EAAfA,EAAiBvD,UACV,QAAfwD,EAAAF,EAASI,cAAM,IAAAF,GAAfA,EAAiBG,SAAyB,QAAfF,EAAAH,EAASI,cAAM,IAAAD,OAAA,EAAfA,EAAiBE,UAAWjD,EACzDU,EAAYkC,EAASI,OAAOC,QACvBvC,GAAY,EACrB,GACF,CACF,GAAG,CAACZ,EAAYa,EAAQX,IAwCxB,OACEnC,EAAAA,EAAAA,MAACqF,EAAM,CAAAlF,SAAA,CACJ8B,GAAcO,GACbpC,EAAAA,EAAAA,KAACkF,EAAAA,EAAM,CAACxF,MAAM,UAAUC,UAAU,gBAElC0B,IACErB,EAAAA,EAAAA,KAACmF,EAAQ,CAAApF,SACNsB,EAAS+D,KAAI,SAAAC,GAAO,OACnBrF,EAAAA,EAAAA,KAAA,OAAAD,UACEH,EAAAA,EAAAA,MAAC0F,EAAO,CACN3F,UAAW0F,EAAQE,WAAaxD,EAAS,OAAS,WAAWhC,SAAA,CAE5DsF,EAAQE,WAAaxD,IAAU/B,EAAAA,EAAAA,KAAA,KAAAD,SAAG,QAClCsF,EAAQG,SALHH,EAAQnB,GAOZ,OAKD,QAAXxB,GAAoC,SAAhBE,KACpBhD,EAAAA,EAAAA,MAAC6F,EAAI,CAACC,SAAU,SAAAC,GAAC,OA3DS,SAAAA,GAC9BtD,GAAa,GACb,IAAMgD,EAAU,CACdE,SAAUxD,EACVyD,KAAM/D,EACNyC,IAAI0B,EAAAA,EAAAA,OAGND,EAAEE,iBACa,QAAXnD,GACFoD,EAAAA,EAAAA,IAAc/D,EAAQa,EAAayC,GAASU,MAAK,SAAAC,GAAG,OAClD/E,EAAgB,CAAEiD,GAAI8B,EAAI9B,GAAIC,KAAMvB,GAAc,KAGpDqD,EAAAA,EAAAA,IAAcvD,EAAQ2C,GAExBM,EAAEO,OAAOC,QACT9D,GAAa,EACf,CAyC2B+D,CAAwBT,EAAE,EAAC5F,SAAA,CAClC,QAAX2C,GAAoBF,IAAaI,IAChC5C,EAAAA,EAAAA,KAACT,EAAU,CAACE,KAAM,GAAIC,MAAM,UAAUC,UAAU,WAElDK,EAAAA,EAAAA,KAAA,YACEqG,SAAU,SAAAV,GACRjE,EAAgBiE,EAAEO,OAAOI,MAC3B,EACAC,QAtCM,WACd,GAAI7D,GAAqB,QAAXA,EAAkB,CAC9B,IAAM8D,GAAU/B,EAAAA,EAAAA,IAAIZ,EAAAA,GAAW,QAASnB,IACxC+D,EAAAA,EAAAA,IAAUD,EAAS,CACjBxB,OAAQjD,GAEZ,CACF,EAgCU2E,OAhDK,WACb,GAAIhE,GAAqB,QAAXA,EAAkB,CAC9B,IAAM8D,GAAU/B,EAAAA,EAAAA,IAAIZ,EAAAA,GAAW,QAASnB,IACxC+D,EAAAA,EAAAA,IAAUD,EAAS,CACjBxB,OAAQ,MAEZ,CACF,KA2CQhF,EAAAA,EAAAA,KAAA,UAAQ2G,UAAWlF,EAAamF,OAAOC,OAAQC,KAAK,SAAQ/G,UAC1DC,EAAAA,EAAAA,KAAC+G,EAAAA,IAAe,CAACtH,KAAK,OAAOC,MAAM,iBAM/C,EAEMuF,EAASxE,EAAAA,GAAAA,IAAUF,IAAAA,GAAAC,EAAAA,EAAAA,GAAA,+IASnB8E,EAAU7E,EAAAA,GAAAA,GAASC,IAAAA,GAAAF,EAAAA,EAAAA,GAAA,kbA0BnBiF,EAAOhF,EAAAA,GAAAA,KAAWuG,IAAAA,GAAAxG,EAAAA,EAAAA,GAAA,osBAwClB2E,EAAW1E,EAAAA,GAAAA,GAASwG,IAAAA,GAAAzG,EAAAA,EAAAA,GAAA,4G,UC/Mb0G,EAAW,SAAH1H,GAAkB,IAAZuF,EAAIvF,EAAJuF,KACzBnE,GAAwCC,EAAAA,EAAAA,MAAiBC,GAAAC,EAAAA,EAAAA,GAAAH,EAAA,GAAlDI,EAAYF,EAAA,GAAEG,EAAeH,EAAA,GACpCI,GAAkDC,EAAAA,EAAAA,YAAUC,GAAAL,EAAAA,EAAAA,GAAAG,EAAA,GAArDiG,EAAiB/F,EAAA,GAAEgG,EAAoBhG,EAAA,GAC9CG,GAA4CJ,EAAAA,EAAAA,YAAUK,GAAAT,EAAAA,EAAAA,GAAAQ,EAAA,GAA/C8F,EAAc7F,EAAA,GAAE8F,EAAiB9F,EAAA,GACxCG,GAAsCR,EAAAA,EAAAA,YAAUS,GAAAb,EAAAA,EAAAA,GAAAY,EAAA,GAAzCiB,EAAWhB,EAAA,GAAE2F,EAAc3F,EAAA,GAClCM,GAAgCf,EAAAA,EAAAA,WAAS,GAAMgB,GAAApB,EAAAA,EAAAA,GAAAmB,EAAA,GAAxCM,EAAQL,EAAA,GAAEM,EAAWN,EAAA,GAC5BG,GAAkCnB,EAAAA,EAAAA,WAAS,GAAMoB,GAAAxB,EAAAA,EAAAA,GAAAuB,EAAA,GAA1CF,EAASG,EAAA,GAAEF,EAAYE,EAAA,GACtBR,GAAWC,EAAAA,EAAAA,YAAWC,EAAAA,IAAtBF,OACFW,EAAS1B,EAAa2B,IAAI,MAE1B6E,GAAWC,EAAAA,EAAAA,UACf,kBAAM1C,EAAK2C,QAAQC,MAAK,SAAAzD,GAAE,OAAIA,IAAOnC,CAAM,GAAC,GAC5C,CAACgD,EAAK2C,QAAS3F,IAgCjB,OA7BAgB,EAAAA,EAAAA,YAAU,WACRV,GAAa,IACbuF,EAAAA,EAAAA,IAAcJ,GACXzB,MAAK,SAAAC,GACJ,IAAA6B,EAAmC7B,EAAI8B,MAA/BC,EAAQF,EAARE,SAAUC,EAAQH,EAARG,SAAU9D,EAAE2D,EAAF3D,GAE5BkD,EAAqBW,GACrBT,EAA0B,OAARU,QAAQ,IAARA,EAAAA,EAAYC,GAC9BV,EAAerD,GACf7B,GAAa,EACf,IACC6F,OAAM,SAAAC,GACLtF,QAAQC,IAAIqF,GACZ9F,GAAa,EACf,IACC+F,SAAQ,kBAAM/F,GAAa,EAAM,GACtC,GAAG,CAACmF,EAAUzF,KAEdgB,EAAAA,EAAAA,YAAU,WACR,GAAIL,EAAQ,CACV,IAAM8B,GAASC,EAAAA,EAAAA,IAAIZ,EAAAA,GAAW,QAASnB,IACvCgC,EAAAA,EAAAA,IAAWF,GAAQ,SAAAG,GAAa,IAADC,EAAAC,EACV,QAAfD,EAAAD,EAASI,cAAM,IAAAH,GAAfA,EAAiBI,SAAyB,QAAfH,EAAAF,EAASI,cAAM,IAAAF,OAAA,EAAfA,EAAiBG,UAAWjD,EACzDU,EAAYkC,EAASI,OAAOC,QACvBvC,GAAY,EACrB,GACF,CACF,GAAG,CAACC,EAAQX,KAGVnC,EAAAA,EAAAA,MAACyI,EAAI,CACHC,QAAS,kBAAMrH,EAAgB,CAAEiD,GAAIa,EAAKb,GAAIC,KAAMvB,GAAc,EAClEjD,UAAW+C,IAAWqC,EAAKb,IAAM,WAAWnE,SAAA,EAG5CC,EAAAA,EAAAA,KAACuI,EAAa,CAAAxI,UACVqC,IACApC,EAAAA,EAAAA,KAAA,OACEwI,IAAKnB,EACLpH,MAAO,CAAEC,MAAO,OAAQC,OAAQ,OAAQsI,UAAW,SACnDC,IAAI,cAIV9I,EAAAA,EAAAA,MAAC+I,EAAI,CAAA5I,SAAA,CACDqC,GAGApC,EAAAA,EAAAA,KAAA,WAFAA,EAAAA,EAAAA,KAAA,KAAGC,MAAO,CAAE2I,WAAY,KAAM7I,SAAEoH,IAIhC/E,GAWApC,EAAAA,EAAAA,KAAA,WAVAA,EAAAA,EAAAA,KAAA,KACEC,MAAO,CACL4I,aAAc,WACdC,SAAU,SACVC,WAAY,UACZhJ,SAEDgF,EAAK1D,SAAS0D,EAAK1D,SAASwF,OAAS,GAAGrB,UAM9ChD,IAAaI,IACZ5C,EAAAA,EAAAA,KAACT,EAAU,CAACE,KAAM,EAAGC,MAAM,QAAQC,UAAU,YAhC1CoF,EAAKb,GAoChB,EAEMmE,EAAO5H,EAAAA,GAAAA,GAASF,IAAAA,GAAAC,EAAAA,EAAAA,GAAA,4XAqBhB+H,EAAgB9H,EAAAA,GAAAA,IAAUC,IAAAA,GAAAF,EAAAA,EAAAA,GAAA,+JAU1BmI,EAAOlI,EAAAA,GAAAA,IAAUuG,IAAAA,GAAAxG,EAAAA,EAAAA,GAAA,wRCvDjBwI,EAAevI,EAAAA,GAAAA,EAAQF,IAAAA,GAAAC,EAAAA,EAAAA,GAAA,mMAWvByI,EAAYxI,EAAAA,GAAAA,GAASC,IAAAA,GAAAF,EAAAA,EAAAA,GAAA,sLAW3B,EAnFqB,WACnB,IAAAU,GAA0BC,EAAAA,EAAAA,UAAS,IAAGC,GAAAL,EAAAA,EAAAA,GAAAG,EAAA,GAA/BgI,EAAK9H,EAAA,GAAE+H,EAAQ/H,EAAA,GACtBR,GAAuBC,EAAAA,EAAAA,MAAhBG,GAAiCD,EAAAA,EAAAA,GAAAH,EAAA,GAArB,GACnBW,GAAkCJ,EAAAA,EAAAA,WAAS,GAAMK,GAAAT,EAAAA,EAAAA,GAAAQ,EAAA,GAA1Ca,EAASZ,EAAA,GAAEa,EAAYb,EAAA,GACtBO,GAAWC,EAAAA,EAAAA,YAAWC,EAAAA,IAAtBF,OACFW,EAAS1B,EAAa2B,IAAI,MAC1BC,EAAc5B,EAAa2B,IAAI,SAErCI,EAAAA,EAAAA,YAAU,WACRV,GAAa,GACb+G,EAASrH,EACX,GAAG,CAACA,IAEJ,IAAMqH,EAAW,SAAArH,GACf,IAAMsB,GAAIM,EAAAA,EAAAA,KACRC,EAAAA,EAAAA,IAAWC,EAAAA,GAAW,UACtBC,EAAAA,EAAAA,IAAM,UAAW,iBAAkB/B,KAGrC2C,EAAAA,EAAAA,IAAWrB,GAAG,SAAAC,GACZ,IAAM4F,EAAQ,GACd5F,EAAc+F,SAAQ,SAAA5E,GACpByE,EAAMI,MAAIC,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAI9E,EAAIM,QAAM,IAAEb,GAAIO,EAAIP,KACtC,IACAiF,EAASD,GACT7G,GAAa,EACf,GACF,EAEA,OACErC,EAAAA,EAAAA,KAAA,OACEC,MAAO,CACLE,OAAQ,qBACRqJ,UAAW,GACXC,QAAS,OACTC,SAAU,YACV3J,SAEDqC,GACCpC,EAAAA,EAAAA,KAACkF,EAAAA,GAAM,CAACxF,MAAM,aAEdE,EAAAA,EAAAA,MAAA+J,EAAAA,SAAA,CAAA5J,SAAA,EACEC,EAAAA,EAAAA,KAACiJ,EAAS,CAAAlJ,SACPmJ,EAAM9D,KAAI,SAAAwE,GAAI,OACb5J,EAAAA,EAAAA,KAACkH,EAAQ,CAACnC,KAAM6E,GAAWA,EAAK1F,GAAM,MAG9B,QAAXxB,GAAqC,IAAjBwG,EAAMrC,QAAgC,SAAhBjE,GACzC5C,EAAAA,EAAAA,KAACgJ,EAAY,CAAAjJ,SAAC,0BACI,SAAhB6C,GACF5C,EAAAA,EAAAA,KAACgJ,EAAY,CAAAjJ,SAAC,kBAEH,QAAX2C,IAAoB1C,EAAAA,EAAAA,KAACgJ,EAAY,CAAAjJ,SAAC,kBAEvB,QAAX2C,GAAoC,SAAhBE,KAA2B5C,EAAAA,EAAAA,KAACW,EAAI,QAKhE,C","sources":["components/TypingDots/TypingDots.jsx","components/Chat.jsx","components/ChatItem/ChatItem.jsx","pages/MessagesPage/MessagesPage.jsx"],"sourcesContent":["import styled, { keyframes } from 'styled-components';\n\nexport const TypingDots = ({ size, color, className }) => {\n  return (\n    <Dots className={`bouncing-loader ${className}`}>\n      <div style={{ width: size, height: size, backgroundColor: color }}></div>\n      <div style={{ width: size, height: size, backgroundColor: color }}></div>\n      <div style={{ width: size, height: size, backgroundColor: color }}></div>\n    </Dots>\n  );\n};\n\nconst loaderAnimation = keyframes`\nto {\n    opacity: 0.1;\n    transform: translateY(-5px);\n}\n`;\n\nconst Dots = styled.div`\n  display: flex;\n  justify-content: center;\n  position: absolute;\n\n  &.large {\n    bottom: 110%;\n\n    & > div {\n      margin: 3px 6px;\n    }\n  }\n\n  &.small {\n    top: 15px;\n    right: 10px;\n\n    & > div {\n      margin: 3px 2px;\n    }\n  }\n\n  & > div {\n    border-radius: 50%;\n    opacity: 1;\n    animation: ${loaderAnimation} 0.6s infinite alternate;\n  }\n\n  & > div:nth-child(2) {\n    animation-delay: 0.2s;\n  }\n\n  & > div:nth-child(3) {\n    animation-delay: 0.4s;\n  }\n`;\n","import { firestore } from 'config/firebase';\nimport { authContext } from 'context';\nimport { query } from 'firebase/database';\nimport {\n  collection,\n  doc,\n  getDocs,\n  onSnapshot,\n  updateDoc,\n  where,\n} from 'firebase/firestore';\nimport { useContext, useEffect, useState } from 'react';\nimport { useSearchParams } from 'react-router-dom';\nimport styled from 'styled-components';\nimport { addNewMessage, createNewChat } from 'utils';\nimport { Loader } from './Loader/Loader';\nimport { RiSendPlaneFill } from 'react-icons/ri';\nimport { nanoid } from 'nanoid';\nimport { TypingDots } from './TypingDots/TypingDots';\n\nexport const Chat = () => {\n  const [searchParams, setSearchParams] = useSearchParams();\n  const [messages, setMessages] = useState(null);\n  const [messageValue, setMessageValue] = useState('');\n  const [chatExists, setChatExists] = useState(false);\n  const { userId } = useContext(authContext);\n  const [isLoading, setIsLoading] = useState(false);\n  const [isTyping, setIsTyping] = useState(false);\n  const chatId = searchParams.get('id');\n  const recepientId = searchParams.get('with');\n\n  console.log(recepientId, userId);\n\n  useEffect(() => {\n    const checkChatExists = async () => {\n      const q = query(\n        collection(firestore, 'chats'),\n        where('members', 'array-contains', recepientId, userId)\n      );\n      const querySnapshot = await getDocs(q);\n      setChatExists(!querySnapshot.empty);\n      if (!querySnapshot.empty)\n        setSearchParams({\n          id: querySnapshot.docs[0].id,\n          with: recepientId || 'none',\n        });\n      else setSearchParams({ id: 'new', with: recepientId || 'none' });\n    };\n    checkChatExists();\n  }, [recepientId, setSearchParams, userId]);\n\n  useEffect(() => {\n    if (chatId && chatId !== 'new') {\n      const docRef = doc(firestore, 'chats', chatId);\n      onSnapshot(docRef, snapshot => {\n        setMessages(snapshot.data()?.messages);\n        if (snapshot.data()?.typing && snapshot.data()?.typing !== userId) {\n          setIsTyping(snapshot.data().typing);\n        } else setIsTyping(false);\n      });\n    }\n  }, [chatExists, chatId, userId]);\n\n  const onSendMessageFormSubmit = e => {\n    setIsLoading(true);\n    const message = {\n      senderId: userId,\n      text: messageValue,\n      id: nanoid(),\n    };\n\n    e.preventDefault();\n    if (chatId === 'new') {\n      createNewChat(userId, recepientId, message).then(res =>\n        setSearchParams({ id: res.id, with: recepientId })\n      );\n    } else {\n      addNewMessage(chatId, message);\n    }\n    e.target.reset();\n    setIsLoading(false);\n  };\n\n  const onBlur = () => {\n    if (chatId && chatId !== 'new') {\n      const chatRef = doc(firestore, 'chats', chatId);\n      updateDoc(chatRef, {\n        typing: null,\n      });\n    }\n  };\n\n  const onFocus = () => {\n    if (chatId && chatId !== 'new') {\n      const chatRef = doc(firestore, 'chats', chatId);\n      updateDoc(chatRef, {\n        typing: userId,\n      });\n    }\n  };\n\n  return (\n    <Window>\n      {chatExists && isLoading ? (\n        <Loader color=\"#00021a\" className=\"loader-chat\" />\n      ) : (\n        messages && (\n          <Messages>\n            {messages.map(message => (\n              <div key={message.id}>\n                <Message\n                  className={message.senderId === userId ? 'send' : 'received'}\n                >\n                  {message.senderId === userId && <p>You</p>}\n                  {message.text}\n                </Message>\n              </div>\n            ))}\n          </Messages>\n        )\n      )}\n      {(chatId !== 'new' || recepientId !== 'none') && (\n        <Form onSubmit={e => onSendMessageFormSubmit(e)}>\n          {chatId !== 'new' && isTyping === recepientId && (\n            <TypingDots size={10} color=\"#00021a\" className=\"large\" />\n          )}\n          <textarea\n            onChange={e => {\n              setMessageValue(e.target.value);\n            }}\n            onFocus={onFocus}\n            onBlur={onBlur}\n          />\n          <button disabled={!messageValue.trim().length} type=\"submit\">\n            <RiSendPlaneFill size=\"100%\" color=\"white\" />\n          </button>\n        </Form>\n      )}\n    </Window>\n  );\n};\n\nconst Window = styled.div`\n  height: calc(100vh - 61px);\n  width: 100%;\n  display: grid;\n  padding: 10px;\n  box-sizing: border-box;\n  position: relative;\n`;\n\nconst Message = styled.li`\n  width: 40%;\n  padding: 12px;\n  border-radius: 20px;\n  font-family: 'Nunito', sans-serif;\n  word-break: break-all;\n  position: relative;\n  &.received {\n    color: #00021a;\n    border: 1px solid orange;\n  }\n\n  &.send {\n    background-color: aliceblue;\n    color: #00021a;\n    border: 1px solid #00021a;\n    margin-left: auto;\n  }\n\n  & > p {\n    font-size: 12px;\n    color: grey;\n    bottom: 100%;\n  }\n`;\n\nconst Form = styled.form`\n  align-self: end;\n  height: auto;\n  width: auto;\n  display: flex;\n  justify-content: space-between;\n  position: relative;\n\n  & textarea {\n    max-width: 100%;\n    padding: 10px 20px;\n    font-size: 17px;\n    box-sizing: border-box;\n    flex: 1;\n    border: 1px solid #00021a;\n    font-family: 'Nunito', sans-serif;\n    min-height: 70px;\n    border-radius: 30px;\n    resize: none;\n\n    &::-webkit-scrollbar {\n      display: none;\n    }\n  }\n\n  & button {\n    width: 50px;\n    height: 50px;\n    margin-left: 5px;\n    background-color: orange;\n    border: none;\n    border-radius: 100%;\n    padding: 10px;\n\n    &:disabled {\n      background-color: grey;\n    }\n  }\n`;\n\nconst Messages = styled.ul`\n  display: flex;\n  width: 100%;\n  flex-direction: column;\n  gap: 10px;\n  overflow-y: scroll;\n`;\n","import { useContext, useEffect, useMemo, useState } from 'react';\nimport { useSearchParams } from 'react-router-dom';\nimport { fetchUserInfo } from 'utils';\nimport avatarPlaceholder from '../../assets/images/avatar-placeholder.png';\nimport styled from 'styled-components';\nimport { authContext } from 'context';\nimport { doc, onSnapshot } from 'firebase/firestore';\nimport { firestore } from 'config/firebase';\nimport { TypingDots } from 'components/TypingDots/TypingDots';\n\nexport const ChatItem = ({ data }) => {\n  const [searchParams, setSearchParams] = useSearchParams();\n  const [recepientUsername, setRecepientUsername] = useState();\n  const [recepientPhoto, setRecepientPhoto] = useState();\n  const [recepientId, setRecepientId] = useState();\n  const [isTyping, setIsTyping] = useState(false);\n  const [isLoading, setIsLoading] = useState(false);\n  const { userId } = useContext(authContext);\n  const chatId = searchParams.get('id');\n\n  const memberId = useMemo(\n    () => data.members.find(id => id !== userId),\n    [data.members, userId]\n  );\n\n  useEffect(() => {\n    setIsLoading(true);\n    fetchUserInfo(memberId)\n      .then(res => {\n        const { username, photoUrl, id } = res.val();\n\n        setRecepientUsername(username);\n        setRecepientPhoto(photoUrl ?? avatarPlaceholder);\n        setRecepientId(id);\n        setIsLoading(false);\n      })\n      .catch(error => {\n        console.log(error);\n        setIsLoading(false);\n      })\n      .finally(() => setIsLoading(false));\n  }, [memberId, userId]);\n\n  useEffect(() => {\n    if (chatId) {\n      const docRef = doc(firestore, 'chats', chatId);\n      onSnapshot(docRef, snapshot => {\n        if (snapshot.data()?.typing && snapshot.data()?.typing !== userId) {\n          setIsTyping(snapshot.data().typing);\n        } else setIsTyping(false);\n      });\n    }\n  }, [chatId, userId]);\n\n  return (\n    <Item\n      onClick={() => setSearchParams({ id: data.id, with: recepientId })}\n      className={chatId === data.id && 'selected'}\n      key={data.id}\n    >\n      <AvatarWrapper>\n        {!isLoading && (\n          <img\n            src={recepientPhoto}\n            style={{ width: '100%', height: '100%', objectFit: 'cover' }}\n            alt=\"avatar\"\n          />\n        )}\n      </AvatarWrapper>\n      <Data>\n        {!isLoading ? (\n          <p style={{ fontWeight: 700 }}>{recepientUsername}</p>\n        ) : (\n          <div></div>\n        )}\n        {!isLoading ? (\n          <p\n            style={{\n              textOverflow: 'ellipsis',\n              overflow: 'hidden',\n              whiteSpace: 'nowrap',\n            }}\n          >\n            {data.messages[data.messages.length - 1].text}\n          </p>\n        ) : (\n          <div></div>\n        )}\n      </Data>\n      {isTyping === recepientId && (\n        <TypingDots size={5} color=\"white\" className=\"small\" />\n      )}\n    </Item>\n  );\n};\n\nconst Item = styled.li`\n  background-color: white;\n  border-radius: 15px;\n  border: 1px solid white;\n  height: 70px;\n  display: flex;\n  padding: 10px;\n  align-items: center;\n  box-sizing: border-box;\n  gap: 10px;\n  font-family: 'Nunito', sans-serif;\n  width: 230px;\n  position: relative;\n  cursor: pointer;\n\n  &.selected {\n    background-color: #00021a;\n    color: white;\n  }\n`;\n\nconst AvatarWrapper = styled.div`\n  min-width: 50px;\n  width: 50px;\n  min-height: 50px;\n  height: 50px;\n  border-radius: 30px;\n  overflow: hidden;\n  background-color: #ced4da;\n`;\n\nconst Data = styled.div`\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  white-space: nowrap;\n  overflow: hidden;\n  width: 100%;\n\n  & div {\n    height: 12px;\n    border-radius: 5px;\n    width: 100%;\n    background-color: #ced4da;\n  }\n`;\n","import { Loader } from 'components';\nimport { Chat } from 'components/Chat';\nimport { ChatItem } from 'components/ChatItem/ChatItem';\nimport { firestore } from 'config/firebase';\nimport { authContext } from 'context';\nimport { query } from 'firebase/database';\nimport { collection, onSnapshot, where } from 'firebase/firestore';\nimport { useContext, useEffect, useState } from 'react';\nimport { useSearchParams } from 'react-router-dom';\nimport styled from 'styled-components';\n\nconst MessagesPage = () => {\n  const [chats, setChats] = useState([]);\n  const [searchParams] = useSearchParams();\n  const [isLoading, setIsLoading] = useState(false);\n  const { userId } = useContext(authContext);\n  const chatId = searchParams.get('id');\n  const recepientId = searchParams.get('with');\n\n  useEffect(() => {\n    setIsLoading(true);\n    getChats(userId);\n  }, [userId]);\n\n  const getChats = userId => {\n    const q = query(\n      collection(firestore, 'chats'),\n      where('members', 'array-contains', userId)\n    );\n\n    onSnapshot(q, querySnapshot => {\n      const chats = [];\n      querySnapshot.forEach(doc => {\n        chats.push({ ...doc.data(), id: doc.id });\n      });\n      setChats(chats);\n      setIsLoading(false);\n    });\n  };\n\n  return (\n    <div\n      style={{\n        height: 'calc(100vh - 61px)',\n        marginTop: 61,\n        display: 'flex',\n        position: 'relative',\n      }}\n    >\n      {isLoading ? (\n        <Loader color=\"#00021a\" />\n      ) : (\n        <>\n          <ChatsList>\n            {chats.map(chat => (\n              <ChatItem data={chat} key={chat.id} />\n            ))}\n          </ChatsList>\n          {chatId === 'new' && chats.length === 0 && recepientId === 'none' ? (\n            <StartMessage>You have no chats yet</StartMessage>\n          ) : recepientId === 'none' ? (\n            <StartMessage>Select a chat</StartMessage>\n          ) : (\n            chatId === 'new' && <StartMessage>Start a chat</StartMessage>\n          )}\n          {(chatId !== 'new' || recepientId !== 'none') && <Chat />}\n        </>\n      )}\n    </div>\n  );\n};\n\nconst StartMessage = styled.p`\n  position: absolute;\n  top: 50%;\n  left: 60%;\n  transform: translate(-60%, -50%);\n  font-family: 'Nunito', sans-serif;\n  font-size: 50px;\n  color: #00021a;\n  font-weight: 700;\n`;\n\nconst ChatsList = styled.ul`\n  height: 100%;\n  overflowy: scroll;\n  background-color: #00021a;\n  padding: 10px;\n  box-sizing: border-box;\n  display: flex;\n  flex-direction: column;\n  gap: 5px;\n`;\n\nexport default MessagesPage;\n"],"names":["TypingDots","_ref","size","color","className","_jsxs","Dots","concat","children","_jsx","style","width","height","backgroundColor","loaderAnimation","keyframes","_templateObject","_taggedTemplateLiteral","styled","_templateObject2","Chat","_useSearchParams","useSearchParams","_useSearchParams2","_slicedToArray","searchParams","setSearchParams","_useState","useState","_useState2","messages","setMessages","_useState3","_useState4","messageValue","setMessageValue","_useState5","_useState6","chatExists","setChatExists","userId","useContext","authContext","_useState7","_useState8","isLoading","setIsLoading","_useState9","_useState10","isTyping","setIsTyping","chatId","get","recepientId","console","log","useEffect","checkChatExists","_asyncToGenerator","_regeneratorRuntime","mark","_callee","q","querySnapshot","wrap","_context","prev","next","query","collection","firestore","where","getDocs","sent","empty","id","with","docs","stop","apply","arguments","docRef","doc","onSnapshot","snapshot","_snapshot$data","_snapshot$data2","_snapshot$data3","data","typing","Window","Loader","Messages","map","message","Message","senderId","text","Form","onSubmit","e","nanoid","preventDefault","createNewChat","then","res","addNewMessage","target","reset","onSendMessageFormSubmit","onChange","value","onFocus","chatRef","updateDoc","onBlur","disabled","trim","length","type","RiSendPlaneFill","_templateObject3","_templateObject4","ChatItem","recepientUsername","setRecepientUsername","recepientPhoto","setRecepientPhoto","setRecepientId","memberId","useMemo","members","find","fetchUserInfo","_res$val","val","username","photoUrl","avatarPlaceholder","catch","error","finally","Item","onClick","AvatarWrapper","src","objectFit","alt","Data","fontWeight","textOverflow","overflow","whiteSpace","StartMessage","ChatsList","chats","setChats","getChats","forEach","push","_objectSpread","marginTop","display","position","_Fragment","chat"],"sourceRoot":""}