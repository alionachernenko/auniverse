"use strict";(self.webpackChunkauniverse=self.webpackChunkauniverse||[]).push([[322],{322:function(n,e,t){t.r(e),t.d(e,{default:function(){return D}});var i,r,a,o,s,d,c,l,u,f=t(168),h=t(1413),p=t(9439),x=t(4165),g=t(5861),b=t(5353),v=t(9373),w=t(2685),m=t(7799),Z=t(2791),y=t(1087),j=t(7691),S=t(2418),k=t(854),P=t(5984),I=t(7425),z=t(184),C=function(){var n=(0,y.lr)(),e=(0,p.Z)(n,2),t=e[0],i=e[1],r=(0,Z.useState)(null),a=(0,p.Z)(r,2),o=a[0],s=a[1],d=(0,Z.useState)(""),c=(0,p.Z)(d,2),l=c[0],u=c[1],f=(0,Z.useState)(!1),h=(0,p.Z)(f,2),j=h[0],C=h[1],U=(0,Z.useContext)(v.gX).userId,O=t.get("id"),L=t.get("with"),X=(0,Z.useState)(!1),B=(0,p.Z)(X,2),F=B[0],T=B[1],D=(0,Z.useState)(!1),Q=(0,p.Z)(D,2),W=Q[0],Y=Q[1];(0,Z.useEffect)((function(){T(!0);var n=function(){var n=(0,g.Z)((0,x.Z)().mark((function n(){var e,t;return(0,x.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e=(0,w.IO)((0,m.hJ)(b.RZ,"chats"),(0,m.ar)("members","array-contains",L)),n.next=3,(0,m.PL)(e);case 3:t=n.sent,C(!t.empty),t.empty?i({id:"new",with:L||"none"}):i({id:t.docs[0].id,with:L||"none"});case 6:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();n(),T(!1)}),[L,i]),(0,Z.useEffect)((function(){if(T(!0),O){var n=(0,m.JU)(b.RZ,"chats",O);(0,m.cf)(n,(function(n){var e;s(null===(e=n.data())||void 0===e?void 0:e.messages),T(!1),n.data().typing&&n.data().typing!==U?Y(n.data().typing):Y(!1)}))}}),[j,O,U]);return(0,z.jsxs)(J,{children:[F?(0,z.jsx)(k.a,{color:"#00021a",className:"loader-chat"}):j&&o&&(0,z.jsx)(R,{children:o.map((function(n){return(0,z.jsxs)("div",{children:[n.senderId===U&&(0,z.jsx)("p",{style:{fontSize:12,color:"grey",marginBottom:2,marginLeft:20},children:"You"}),(0,z.jsx)(N,{className:n.senderId===U?"send":"received",children:n.text})]},(0,P.x0)())}))}),"new"!==O&&W===L&&(0,z.jsx)("p",{children:"Typing..."}),("new"!==O||"none"!==L)&&(0,z.jsxs)(E,{onSubmit:function(n){return function(n){T(!0);var e={senderId:U,text:l};n.preventDefault(),"new"===O?(0,S.bJ)(U,L,e).then((function(n){return i({id:n.id,with:L})})):(0,S.PL)(O,e),n.target.reset(),T(!1)}(n)},children:[(0,z.jsx)("textarea",{onChange:function(n){u(n.target.value)},onFocus:function(){var n=(0,m.JU)(b.RZ,"chats",O);(0,m.r7)(n,{typing:U})},onBlur:function(){var n=(0,m.JU)(b.RZ,"chats",O);(0,m.r7)(n,{typing:null})}}),(0,z.jsx)("button",{disabled:""===l,type:"submit",children:(0,z.jsx)(I.OIQ,{size:"100%",color:"white"})})]})]})},J=j.ZP.div(i||(i=(0,f.Z)(["\n  height: calc(100vh - 61px);\n  width: 100%;\n  display: grid;\n  padding: 10px;\n  box-sizing: border-box;\n  position: relative;\n"]))),N=j.ZP.li(r||(r=(0,f.Z)(["\n  width: 40%;\n  padding: 12px;\n  border-radius: 20px;\n  font-family: 'Nunito', sans-serif;\n  word-break: break-all;\n  &.received {\n    color: #00021a;\n    border: 1px solid orange;\n  }\n\n  &.send {\n    background-color: aliceblue;\n    color: #00021a;\n    border: 1px solid #00021a;\n  }\n"]))),E=j.ZP.form(a||(a=(0,f.Z)(["\n  align-self: end;\n  height: auto;\n  width: auto;\n  display: flex;\n  justify-content: space-between;\n\n  & textarea {\n    max-width: 100%;\n    padding: 10px 20px;\n    font-size: 17px;\n    box-sizing: border-box;\n    flex: 1;\n    border: 1px solid #00021a;\n    font-family: 'Nunito', sans-serif;\n    min-height: 70px;\n    border-radius: 30px;\n    resize: none;\n\n    &::-webkit-scrollbar {\n      display: none;\n    }\n  }\n\n  & button {\n    width: 50px;\n    height: 50px;\n    margin-left: 5px;\n    background-color: orange;\n    border: none;\n    border-radius: 100%;\n    padding: 10px;\n\n    &:disabled {\n      background-color: grey;\n    }\n  }\n"]))),R=j.ZP.ul(o||(o=(0,f.Z)(["\n  display: flex;\n  width: 100%;\n  flex-direction: column;\n  gap: 10px;\n  overflow-y: scroll;\n"]))),U=t(6189),O=function(n){var e=n.data,t=(0,y.lr)(),i=(0,p.Z)(t,2),r=i[0],a=i[1],o=(0,Z.useState)(),s=(0,p.Z)(o,2),d=s[0],c=s[1],l=(0,Z.useState)(),u=(0,p.Z)(l,2),f=u[0],h=u[1],x=(0,Z.useState)(),g=(0,p.Z)(x,2),w=g[0],j=g[1],k=(0,Z.useState)(!1),P=(0,p.Z)(k,2),I=P[0],C=P[1],J=(0,Z.useContext)(v.gX).userId,N=r.get("id");return(0,Z.useEffect)((function(){(0,S.CS)(e.members.find((function(n){return n!==J}))).then((function(n){var e=n.val(),t=e.username,i=e.photoUrl,r=e.id;c(t),h(null!==i&&void 0!==i?i:U),j(r)})).catch((function(n){return console.log(n)}))}),[e.members,e.recepientId,J]),(0,Z.useEffect)((function(){if(N){var n=(0,m.JU)(b.RZ,"chats",N);(0,m.cf)(n,(function(n){n.data().typing&&n.data().typing!==J?C(n.data().typing):C(!1)}))}}),[N,J]),(0,z.jsxs)(L,{onClick:function(){return a({id:e.id,with:w})},className:N===e.id&&"selected",children:[(0,z.jsx)(X,{children:(0,z.jsx)("img",{src:f,style:{width:"100%",height:"100%",objectFit:"cover"},alt:"avatar"})}),(0,z.jsxs)(B,{children:[(0,z.jsx)("p",{style:{fontWeight:700},children:d}),(0,z.jsx)("p",{style:{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"},children:e.messages[e.messages.length-1].text}),I===w&&(0,z.jsx)("p",{children:"..."})]})]})},L=j.ZP.li(s||(s=(0,f.Z)(["\n  background-color: white;\n  border-radius: 15px;\n  border: 1px solid white;\n  height: 70px;\n  display: flex;\n  padding: 10px;\n  align-items: center;\n  box-sizing: border-box;\n  gap: 10px;\n  font-family: 'Nunito', sans-serif;\n\n  &.selected {\n    background-color: #00021a;\n    color: white;\n  }\n"]))),X=j.ZP.div(d||(d=(0,f.Z)(["\n  min-width: 50px;\n  width: 50px;\n  min-height: 50px;\n  height: 50px;\n  border-radius: 30px;\n  overflow: hidden;\n"]))),B=j.ZP.div(c||(c=(0,f.Z)(["\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  white-space: nowrap;\n  overflow: hidden;\n"]))),F=j.ZP.p(l||(l=(0,f.Z)(["\n  position: absolute;\n  top: 50%;\n  left: 60%;\n  transform: translate(-60%, -50%);\n  font-family: 'Nunito', sans-serif;\n  font-size: 50px;\n  color: #00021a;\n  font-weight: 700;\n"]))),T=j.ZP.ul(u||(u=(0,f.Z)(["\n  width: 25vw;\n  height: 100%;\n  overflowy: scroll;\n  background-color: #00021a;\n  padding: 10px;\n  box-sizing: border-box;\n  display: flex;\n  flex-direction: column;\n  gap: 5px;\n"]))),D=function(){var n=(0,Z.useState)([]),e=(0,p.Z)(n,2),t=e[0],i=e[1],r=(0,y.lr)(),a=(0,p.Z)(r,1)[0],o=(0,Z.useContext)(v.gX).userId,s=a.get("id"),d=a.get("with");(0,Z.useEffect)((function(){c(o)}),[o]);var c=function(n){var e=(0,w.IO)((0,m.hJ)(b.RZ,"chats"),(0,m.ar)("members","array-contains",n));(0,m.cf)(e,(function(n){var e=[];n.forEach((function(n){e.push((0,h.Z)((0,h.Z)({},n.data()),{},{id:n.id}))})),i(e)}))};return(0,z.jsxs)("div",{style:{height:"calc(100vh - 61px)",marginTop:61,display:"flex",position:"relative"},children:[(0,z.jsx)(T,{children:t.map((function(n){return(0,z.jsx)(O,{data:n})}))}),"new"===s&&("none"===d?(0,z.jsx)(F,{children:"Select a chat"}):(0,z.jsx)(F,{children:"Start a chat"})),(0,z.jsx)(C,{})]})}}}]);
//# sourceMappingURL=322.b91b98eb.chunk.js.map