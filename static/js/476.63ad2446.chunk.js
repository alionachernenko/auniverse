"use strict";(self.webpackChunkauniverse=self.webpackChunkauniverse||[]).push([[476],{4476:function(n,e,t){t.r(e),t.d(e,{default:function(){return A}});var i,r,o,a,s,d,l,c,u,h,p,x=t(168),f=t(1413),g=t(9439),v=t(6862),b=t(4165),m=t(5861),w=t(5353),y=t(9373),Z=t(2685),j=t(7799),k=t(2791),S=t(1087),z=t(7691),N=t(2418),P=t(854),C=t(7425),I=t(5984),J=t(184),E=function(n){var e=n.size,t=n.color,i=n.className;return(0,J.jsxs)(U,{className:"bouncing-loader ".concat(i),children:[(0,J.jsx)("div",{style:{width:e,height:e,backgroundColor:t}}),(0,J.jsx)("div",{style:{width:e,height:e,backgroundColor:t}}),(0,J.jsx)("div",{style:{width:e,height:e,backgroundColor:t}})]})},R=(0,z.F4)(i||(i=(0,x.Z)(["\nto {\n    opacity: 0.1;\n    transform: translateY(-5px);\n}\n"]))),U=z.ZP.div(r||(r=(0,x.Z)(["\n  display: flex;\n  justify-content: center;\n  position: absolute;\n\n  &.large {\n    bottom: 110%;\n\n    & > div {\n      margin: 3px 6px;\n    }\n  }\n\n  &.small {\n    top: 15px;\n    right: 10px;\n\n    & > div {\n      margin: 3px 2px;\n    }\n  }\n\n  & > div {\n    border-radius: 50%;\n    opacity: 1;\n    animation: "," 0.6s infinite alternate;\n  }\n\n  & > div:nth-child(2) {\n    animation-delay: 0.2s;\n  }\n\n  & > div:nth-child(3) {\n    animation-delay: 0.4s;\n  }\n"])),R),F=function(){var n=(0,S.lr)(),e=(0,g.Z)(n,2),t=e[0],i=e[1],r=(0,k.useState)(null),o=(0,g.Z)(r,2),a=o[0],s=o[1],d=(0,k.useState)(""),l=(0,g.Z)(d,2),c=l[0],u=l[1],h=(0,k.useState)(!1),p=(0,g.Z)(h,2),x=p[0],f=p[1],v=(0,k.useContext)(y.gX).userId,z=(0,k.useState)(!1),R=(0,g.Z)(z,2),U=R[0],F=R[1],B=(0,k.useState)(!1),D=(0,g.Z)(B,2),M=D[0],Q=D[1],T=t.get("id"),W=t.get("with");console.log(W,v),(0,k.useEffect)((function(){var n=function(){var n=(0,m.Z)((0,b.Z)().mark((function n(){var e,t;return(0,b.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e=(0,Z.IO)((0,j.hJ)(w.RZ,"chats"),(0,j.ar)("members","array-contains",W,v)),n.next=3,(0,j.PL)(e);case 3:t=n.sent,f(!t.empty),t.empty?i({id:"new",with:W||"none"}):i({id:t.docs[0].id,with:W||"none"});case 6:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();n()}),[W,i,v]),(0,k.useEffect)((function(){if(T&&"new"!==T){var n=(0,j.JU)(w.RZ,"chats",T);(0,j.cf)(n,(function(n){var e,t,i;s(null===(e=n.data())||void 0===e?void 0:e.messages),null!==(t=n.data())&&void 0!==t&&t.typing&&(null===(i=n.data())||void 0===i?void 0:i.typing)!==v?Q(n.data().typing):Q(!1)}))}}),[x,T,v]);return(0,J.jsxs)(O,{children:[x&&U?(0,J.jsx)(P.a,{color:"#00021a",className:"loader-chat"}):a&&(0,J.jsx)(L,{children:a.map((function(n){return(0,J.jsx)("div",{children:(0,J.jsxs)(X,{className:n.senderId===v?"send":"received",children:[n.senderId===v&&(0,J.jsx)("p",{children:"You"}),n.text]})},n.id)}))}),("new"!==T||"none"!==W)&&(0,J.jsxs)(Y,{onSubmit:function(n){return function(n){F(!0);var e={senderId:v,text:c,id:(0,I.x0)()};n.preventDefault(),"new"===T?(0,N.bJ)(v,W,e).then((function(n){return i({id:n.id,with:W})})):(0,N.PL)(T,e),n.target.reset(),F(!1)}(n)},children:["new"!==T&&M===W&&(0,J.jsx)(E,{size:10,color:"#00021a",className:"large"}),(0,J.jsx)("textarea",{onChange:function(n){u(n.target.value)},onFocus:function(){if(T&&"new"!==T){var n=(0,j.JU)(w.RZ,"chats",T);(0,j.r7)(n,{typing:v})}},onBlur:function(){if(T&&"new"!==T){var n=(0,j.JU)(w.RZ,"chats",T);(0,j.r7)(n,{typing:null})}}}),(0,J.jsx)("button",{disabled:!c.trim().length,type:"submit",children:(0,J.jsx)(C.OIQ,{size:"100%",color:"white"})})]})]})},O=z.ZP.div(o||(o=(0,x.Z)(["\n  height: calc(100vh - 61px);\n  width: 100%;\n  display: grid;\n  padding: 10px;\n  box-sizing: border-box;\n  position: relative;\n"]))),X=z.ZP.li(a||(a=(0,x.Z)(["\n  width: 40%;\n  padding: 12px;\n  border-radius: 20px;\n  font-family: 'Nunito', sans-serif;\n  word-break: break-all;\n  position: relative;\n  &.received {\n    color: #00021a;\n    border: 1px solid orange;\n  }\n\n  &.send {\n    background-color: aliceblue;\n    color: #00021a;\n    border: 1px solid #00021a;\n    margin-left: auto;\n  }\n\n  & > p {\n    font-size: 12px;\n    color: grey;\n    bottom: 100%;\n  }\n"]))),Y=z.ZP.form(s||(s=(0,x.Z)(["\n  align-self: end;\n  height: auto;\n  width: auto;\n  display: flex;\n  justify-content: space-between;\n  position: relative;\n\n  & textarea {\n    max-width: 100%;\n    padding: 10px 20px;\n    font-size: 17px;\n    box-sizing: border-box;\n    flex: 1;\n    border: 1px solid #00021a;\n    font-family: 'Nunito', sans-serif;\n    min-height: 70px;\n    border-radius: 30px;\n    resize: none;\n\n    &::-webkit-scrollbar {\n      display: none;\n    }\n  }\n\n  & button {\n    width: 50px;\n    height: 50px;\n    margin-left: 5px;\n    background-color: orange;\n    border: none;\n    border-radius: 100%;\n    padding: 10px;\n\n    &:disabled {\n      background-color: grey;\n    }\n  }\n"]))),L=z.ZP.ul(d||(d=(0,x.Z)(["\n  display: flex;\n  width: 100%;\n  flex-direction: column;\n  gap: 10px;\n  overflow-y: scroll;\n"]))),B=t(6189),D=function(n){var e=n.data,t=(0,S.lr)(),i=(0,g.Z)(t,2),r=i[0],o=i[1],a=(0,k.useState)(),s=(0,g.Z)(a,2),d=s[0],l=s[1],c=(0,k.useState)(),u=(0,g.Z)(c,2),h=u[0],p=u[1],x=(0,k.useState)(),f=(0,g.Z)(x,2),v=f[0],b=f[1],m=(0,k.useState)(!1),Z=(0,g.Z)(m,2),z=Z[0],P=Z[1],C=(0,k.useState)(!1),I=(0,g.Z)(C,2),R=I[0],U=I[1],F=(0,k.useContext)(y.gX).userId,O=r.get("id"),X=(0,k.useMemo)((function(){return e.members.find((function(n){return n!==F}))}),[e.members,F]);return(0,k.useEffect)((function(){U(!0),(0,N.CS)(X).then((function(n){var e=n.val(),t=e.username,i=e.photoUrl,r=e.id;l(t),p(null!==i&&void 0!==i?i:B),b(r),U(!1)})).catch((function(n){console.log(n),U(!1)})).finally((function(){return U(!1)}))}),[X,F]),(0,k.useEffect)((function(){if(O){var n=(0,j.JU)(w.RZ,"chats",O);(0,j.cf)(n,(function(n){var e,t;null!==(e=n.data())&&void 0!==e&&e.typing&&(null===(t=n.data())||void 0===t?void 0:t.typing)!==F?P(n.data().typing):P(!1)}))}}),[O,F]),(0,J.jsxs)(M,{onClick:function(){return o({id:e.id,with:v})},className:O===e.id&&"selected",children:[(0,J.jsx)(Q,{children:!R&&(0,J.jsx)("img",{src:h,style:{width:"100%",height:"100%",objectFit:"cover"},alt:"avatar"})}),(0,J.jsxs)(T,{children:[R?(0,J.jsx)("div",{}):(0,J.jsx)("p",{style:{fontWeight:700},children:d}),R?(0,J.jsx)("div",{}):(0,J.jsx)("p",{style:{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"},children:e.messages[e.messages.length-1].text})]}),z===v&&(0,J.jsx)(E,{size:5,color:"white",className:"small"})]},e.id)},M=z.ZP.li(l||(l=(0,x.Z)(["\n  background-color: white;\n  border-radius: 15px;\n  border: 1px solid white;\n  height: 70px;\n  display: flex;\n  padding: 10px;\n  align-items: center;\n  box-sizing: border-box;\n  gap: 10px;\n  font-family: 'Nunito', sans-serif;\n  width: 230px;\n  position: relative;\n  cursor: pointer;\n\n  &.selected {\n    background-color: #00021a;\n    color: white;\n  }\n"]))),Q=z.ZP.div(c||(c=(0,x.Z)(["\n  min-width: 50px;\n  width: 50px;\n  min-height: 50px;\n  height: 50px;\n  border-radius: 30px;\n  overflow: hidden;\n  background-color: #ced4da;\n"]))),T=z.ZP.div(u||(u=(0,x.Z)(["\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  white-space: nowrap;\n  overflow: hidden;\n  width: 100%;\n\n  & div {\n    height: 12px;\n    border-radius: 5px;\n    width: 100%;\n    background-color: #ced4da;\n  }\n"]))),W=z.ZP.p(h||(h=(0,x.Z)(["\n  position: absolute;\n  top: 50%;\n  left: 60%;\n  transform: translate(-60%, -50%);\n  font-family: 'Nunito', sans-serif;\n  font-size: 50px;\n  color: #00021a;\n  font-weight: 700;\n"]))),q=z.ZP.ul(p||(p=(0,x.Z)(["\n  height: 100%;\n  overflowy: scroll;\n  background-color: #00021a;\n  padding: 10px;\n  box-sizing: border-box;\n  display: flex;\n  flex-direction: column;\n  gap: 5px;\n"]))),A=function(){var n=(0,k.useState)([]),e=(0,g.Z)(n,2),t=e[0],i=e[1],r=(0,S.lr)(),o=(0,g.Z)(r,1)[0],a=(0,k.useState)(!1),s=(0,g.Z)(a,2),d=s[0],l=s[1],c=(0,k.useContext)(y.gX).userId,u=o.get("id"),h=o.get("with");(0,k.useEffect)((function(){l(!0),p(c)}),[c]);var p=function(n){var e=(0,Z.IO)((0,j.hJ)(w.RZ,"chats"),(0,j.ar)("members","array-contains",n));(0,j.cf)(e,(function(n){var e=[];n.forEach((function(n){e.push((0,f.Z)((0,f.Z)({},n.data()),{},{id:n.id}))})),i(e),l(!1)}))};return(0,J.jsx)("div",{style:{height:"calc(100vh - 61px)",marginTop:61,display:"flex",position:"relative"},children:d?(0,J.jsx)(v.aN,{color:"#00021a"}):(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(q,{children:t.map((function(n){return(0,J.jsx)(D,{data:n},n.id)}))}),"new"===u&&0===t.length&&"none"===h?(0,J.jsx)(W,{children:"You have no chats yet"}):"none"===h?(0,J.jsx)(W,{children:"Select a chat"}):"new"===u&&(0,J.jsx)(W,{children:"Start a chat"}),("new"!==u||"none"!==h)&&(0,J.jsx)(F,{})]})})}}}]);
//# sourceMappingURL=476.63ad2446.chunk.js.map